/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/library","sap/ui/core/IconPool","sap/ui/core/theming/Parameters","sap/ui/Device","./library","./ListItemBase","./Image","./StandardListItemRenderer"],function(e,t,i,n,o,a,s,r){"use strict";var p=e.TextDirection;var l=e.ValueState;var h=a.extend("sap.m.StandardListItem",{metadata:{library:"sap.m",properties:{title:{type:"string",group:"Misc",defaultValue:null},description:{type:"string",group:"Misc",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},iconInset:{type:"boolean",group:"Appearance",defaultValue:true},iconDensityAware:{type:"boolean",group:"Misc",defaultValue:true},activeIcon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},info:{type:"string",group:"Misc",defaultValue:null},infoState:{type:"sap.ui.core.ValueState",group:"Misc",defaultValue:l.None},adaptTitleSize:{type:"boolean",group:"Appearance",defaultValue:true},titleTextDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:p.Inherit},infoTextDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:p.Inherit},wrapping:{type:"boolean",group:"Behavior",defaultValue:false},infoStateInverted:{type:"boolean",group:"Appearance",defaultValue:false}},designtime:"sap/m/designtime/StandardListItem.designtime"}});h.prototype.exit=function(){if(this._oImage){this._oImage.destroy("KeepDom")}a.prototype.exit.apply(this,arguments)};h.prototype.setIcon=function(e){var i=this.getIcon();this.setProperty("icon",e);if(this._oImage&&(!e||t.isIconURI(e)!=t.isIconURI(i))){this._oImage.destroy("KeepDom");this._oImage=undefined}return this};h.prototype._getImage=function(){var e=this._oImage;if(e){e.setSrc(this.getIcon());if(e.setDensityAware){e.setDensityAware(this.getIconDensityAware())}}else{e=t.createControlByURI({id:this.getId()+"-img",src:this.getIcon(),densityAware:this.getIconDensityAware(),useIconTooltip:false},s).setParent(this,null,true)}var i=this.getIconInset()?"sapMSLIImg":"sapMSLIImgNoInset";e.addStyleClass(e instanceof s?i:i+"Icon",true);this._oImage=e;return this._oImage};h.prototype._activeHandlingInheritor=function(){if(this._oImage){var e=this.getActiveIcon();e&&this._oImage.setSrc(e)}};h.prototype._inactiveHandlingInheritor=function(){if(this._oImage){this._oImage.setSrc(this.getIcon())}};h.prototype.getContentAnnouncement=function(e){var t="",i=this.getInfoState(),n,o="",a,s="",r,p;if(this.getWrapping()){r=this.getDomRef("titleButton");p=this.getDomRef("descriptionButton");n=this._bTitleTextExpanded?this.getTitle():this._getCollapsedText(this.getTitle());a=this._bDescriptionTextExpanded?this.getDescription():this._getCollapsedText(this.getDescription());if(r){o=r.textContent+" "+e.getText("ACC_CTR_TYPE_BUTTON")}if(p){s=p.textContent+" "+e.getText("ACC_CTR_TYPE_BUTTON")}t+=n+" "+o+" "+a+" "+s+" "}else{t+=this.getTitle()+" "+this.getDescription()+" "}t+=this.getInfo()+" ";if(i!="None"&&i!=this.getHighlight()){t+=e.getText("LIST_ITEM_STATE_"+i.toUpperCase())}return t};h.prototype._measureInfoTextWidth=function(e){if(!h._themeInfo){h._themeInfo={}}if(!h._themeInfo.sFontFamily||e){h._themeInfo.sFontFamily=i.get("sapUiFontFamily")}if(!h._themeInfo.sFontStyleInfoStateInverted||e){h._themeInfo.sFontStyleInfoStateInverted="bold "+parseFloat(i.get("sapMFontSmallSize"))*16+"px"+" "+h._themeInfo.sFontFamily}if(!h._themeInfo.sFontStyle||e){h._themeInfo.sFontStyle=parseFloat(i.get("sapMFontMediumSize"))*16+"px"+" "+h._themeInfo.sFontFamily}if(!h._themeInfo.iBaseFontSize||e){h._themeInfo.iBaseFontSize=parseInt(o.BaseFontSize)||16}if(!h._oCanvas){h._oCanvas=document.createElement("canvas");h._oCtx=h._oCanvas.getContext("2d")}if(this.getInfoStateInverted()){h._oCtx.font=h._themeInfo.sFontStyleInfoStateInverted||""}else{h._oCtx.font=h._themeInfo.sFontStyle||""}return Math.ceil(h._oCtx.measureText(this.getInfo()).width)/h._themeInfo.iBaseFontSize};h.prototype._getInfoTextMinWidth=function(e){if(this.getInfoStateInverted()&&e<=7.5){return e+.625+"rem"}if(e<=7.5){return e+"rem"}return"7.5rem"};h.prototype.ontap=function(e){this._checkExpandCollapse(e);if(!e.isMarked()){return a.prototype.ontap.apply(this,arguments)}};h.prototype.onsapspace=function(e){this._checkExpandCollapse(e,true);if(!e.isMarked()){return a.prototype.onsapspace.apply(this,arguments)}};h.prototype._checkExpandCollapse=function(e,t){var i=e.target,n=i&&i.id;if(n&&n===this.getId()+"-titleButton"){if(t){e.preventDefault()}e.setMarked();return this._toggleExpandCollapse("title",this._bTitleTextExpanded)}if(n&&n===this.getId()+"-descriptionButton"){if(t){e.preventDefault()}e.setMarked();return this._toggleExpandCollapse("description",this._bDescriptionTextExpanded)}};h.prototype._toggleExpandCollapse=function(e,t){var i=this.getDomRef(e+"Text"),n=this.getDomRef(e+"ThreeDots"),o=this.getDomRef(e+"Button"),a=e==="title"?this.getTitle():this.getDescription(),s=sap.ui.getCore().getLibraryResourceBundle("sap.m");if(!t){i.textContent=a;n.textContent=" ";o.textContent=s.getText("TEXT_SHOW_LESS");t=true}else{i.textContent=this._getCollapsedText(a);n.textContent=" ... ";o.textContent=s.getText("TEXT_SHOW_MORE");t=false}if(e==="title"){this._bTitleTextExpanded=t}else{this._bDescriptionTextExpanded=t}};h.prototype._getCollapsedText=function(e){var t=n.system.phone?100:300;return e.substr(0,t)};h.prototype.onThemeChanged=function(e){a.prototype.onThemeChanged.apply(this,arguments);var t=e.theme;if(!this._initialRender){this._initialRender=true;if(!h._themeInfo){h._themeInfo={}}if(!h._themeInfo.sCurrentTheme){h._themeInfo.sCurrentTheme=t}return}var i=this.getDomRef("info");if(i){var n;if(h._themeInfo.sCurrentTheme!==t){h._themeInfo.sCurrentTheme=t;n=this._measureInfoTextWidth(true)}else{n=this._measureInfoTextWidth()}i.style.minWidth=this._getInfoTextMinWidth(n)}};return h});