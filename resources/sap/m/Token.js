/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","./Tokenizer","sap/ui/core/library","sap/ui/core/Icon","./TokenRenderer","sap/ui/core/InvisibleText","sap/ui/events/KeyCodes","sap/ui/core/theming/Parameters","sap/ui/core/Core"],function(e,t,i,r,o,n,a,s,p,c){"use strict";var l=r.TextDirection;var u=t.extend("sap.m.Token",{metadata:{library:"sap.m",properties:{selected:{type:"boolean",group:"Misc",defaultValue:false},key:{type:"string",group:"Misc",defaultValue:""},text:{type:"string",group:"Misc",defaultValue:""},editable:{type:"boolean",group:"Misc",defaultValue:true},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:l.Inherit},editableParent:{type:"boolean",group:"Behavior",defaultValue:true,visibility:"hidden"},truncated:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"}},aggregations:{deleteIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{delete:{},press:{},select:{},deselect:{}}}});u.prototype.init=function(){var e=p.get("_sap_m_Token_Sys_Cancel_Icon")==="true",t=e?"sap-icon://sys-cancel":"sap-icon://decline",i=new o({id:this.getId()+"-icon",src:t,noTabStop:true,press:this._fireDeleteToken.bind(this)});i.addStyleClass("sapMTokenIcon");i.setUseIconTooltip(false);this.setAggregation("deleteIcon",i)};u.prototype.ontouchstart=function(e){if(e.target.id===this.getId()+"-icon"){e.preventDefault()}};u.prototype._getTooltip=function(e,t){var i=e.getTooltip_AsString(),r=c.getLibraryResourceBundle("sap.m").getText("TOKEN_ARIA_DELETABLE");if(t&&!i){return r}return i};u.prototype._onTokenPress=function(e){var t=this.getSelected(),i=e.ctrlKey||e.metaKey,r=true;if(i||e.which===s.SPACE){r=!t}if(!this.getTruncated()){this.setSelected(r)}this.firePress();if(t!==r){if(r){this.fireSelect()}else{this.fireDeselect()}}if(this.getSelected()){this.focus()}};u.prototype.ontap=function(e){var t=this.getAggregation("deleteIcon");if(t&&e.target.id===t.getId()){e.setMark("tokenDeletePress",true);return}e.setMark("tokenTap",this);this._onTokenPress(e)};u.prototype.onsapbackspace=function(e){this._fireDeleteToken(e)};u.prototype.onsapdelete=function(e){this._fireDeleteToken(e)};u.prototype._fireDeleteToken=function(e){if(this.getEditable()&&this.getProperty("editableParent")){this.fireDelete({token:this})}e.preventDefault()};u.prototype.onsapspace=function(e){this._onTokenPress(e);if(e){e.preventDefault();e.stopPropagation()}};u.prototype.onkeydown=function(e){if((e.ctrlKey||e.metaKey)&&e.which===s.SPACE){this.onsapspace(e);e.preventDefault()}};u.prototype.onThemeChanged=function(){var e=this.getAggregation("deleteIcon"),t=p.get("_sap_m_Token_Sys_Cancel_Icon")==="true",i=t?"sap-icon://sys-cancel":"sap-icon://decline";if(e&&e.getSrc()!==i){e.setSrc(i)}};u.prototype.getTruncated=function(){return this.getProperty("truncated")};u.prototype.setTruncated=function(e,t){if(this.getTruncated()===e){return this}return this.setProperty("truncated",e,t)};return u});