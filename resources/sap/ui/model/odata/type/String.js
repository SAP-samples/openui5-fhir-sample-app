/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/model/ValidateException","sap/ui/model/odata/type/ODataType","sap/ui/model/type/String"],function(e,t,n,i){"use strict";var a=/^\d+$/,s=/^0*(?=\d)/;function r(e,t){return t&&t.isDigitSequence&&e&&e.match(a)}function l(t,n){var i,a,s;t.oConstraints=undefined;if(n){a=n.maxLength;if(typeof a==="string"){a=parseInt(a)}if(typeof a==="number"&&!isNaN(a)&&a>0){t.oConstraints={maxLength:a}}else if(a!==undefined){e.warning("Illegal maxLength: "+n.maxLength,null,t.getName())}i=n.isDigitSequence;if(i===true||i==="true"){t.oConstraints=t.oConstraints||{};t.oConstraints.isDigitSequence=true}else if(i!==undefined&&i!==false&&i!=="false"){e.warning("Illegal isDigitSequence: "+i,null,t.getName())}s=n.nullable;if(s===false||s==="false"){t.oConstraints=t.oConstraints||{};t.oConstraints.nullable=false}else if(s!==undefined&&s!==true&&s!=="true"){e.warning("Illegal nullable: "+s,null,t.getName())}}}var o=n.extend("sap.ui.model.odata.type.String",{constructor:function(t,i){var a=t?t.parseKeepsEmptyString:undefined;n.apply(this,arguments);l(this,i);this._sParsedEmptyString=null;if(this.oConstraints&&this.oConstraints.nullable===false&&this.oConstraints.isDigitSequence){this._sParsedEmptyString="0"}else if(a!==undefined){if(a===true){this._sParsedEmptyString=""}else if(a!==false){e.warning("Illegal parseKeepsEmptyString: "+a,null,this.getName())}}}});o.prototype.formatValue=function(e,t){if(e===null&&this.getPrimitiveType(t)==="string"){return""}if(r(e,this.oConstraints)){e=e.replace(s,"")}return i.prototype.formatValue.call(this,e,t)};o.prototype.parseValue=function(e,t){var n;n=e===""?this._sParsedEmptyString:i.prototype.parseValue.apply(this,arguments);if(r(n,this.oConstraints)){n=n.replace(s,"");if(this.oConstraints.maxLength){n=n.padStart(this.oConstraints.maxLength,"0")}}return n};o.prototype.validateValue=function(e){var n=this.oConstraints||{},i=n.maxLength;if(e===null){if(n.nullable!==false){return}}else if(typeof e!=="string"){throw new t("Illegal "+this.getName()+" value: "+e)}else if(n.isDigitSequence){if(!e.match(a)){throw new t(sap.ui.getCore().getLibraryResourceBundle().getText("EnterDigitsOnly"))}if(i&&e.length>i){throw new t(sap.ui.getCore().getLibraryResourceBundle().getText("EnterMaximumOfDigits",[i]))}return}else if(!i||e.length<=i){return}throw new t(sap.ui.getCore().getLibraryResourceBundle().getText(i?"EnterTextMaxLength":"EnterText",[i]))};o.prototype.getName=function(){return"sap.ui.model.odata.type.String"};return o});