/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/Device","sap/base/Log","sap/base/util/extend","sap/ui/core/Component"],function(e,t,i,o){"use strict";return{_routeMatched:function(r,a,n){var s=this._oRouter,g,h,f,_,u=null,l=null,c,d,T,p,C=this;s._stopWaitingTitleChangedFromChild();s._oMatchedRoute=this;s._bMatchingProcessStarted=true;f=i({},s._oConfig,this._oConfig);h=s.getTargets();var v;if(h){v=h._getTitleTargetName(f.target,f.titleTarget);if(v&&s._oPreviousTitleChangedRoute!==this){s._bFireTitleChanged=true;if(s._oOwner&&s._oOwner._bRoutingPropagateTitle){var m=o.getOwnerComponentFor(s._oOwner);var w=m&&m.getRouter();if(w){w._waitForTitleChangedOn(s)}}}else{s._bFireTitleChanged=false}if(this._oConfig.target){p=h._alignTargetsInfo(this._oConfig.target);p.forEach(function(e){e.propagateTitle=e.hasOwnProperty("propagateTitle")?e.propagateTitle:s._oConfig.propagateTitle})}}else{p=this._oConfig.target}if(!a||a===true){c=true;a=Promise.resolve()}if(this._oParent){a=this._oParent._routeMatched(r,a)}else if(this._oNestingParent){this._oNestingParent._routeMatched(r,a,this)}d=Object.assign({},r);d.routeConfig=f;_={name:f.name,arguments:r,config:f};if(n){_.nestedRoute=n}this.fireBeforeMatched(_);s.fireBeforeRouteMatched(_);if(this._oTarget){g=this._oTarget;g._updateOptions(this._convertToTargetOptions(f));a=g._place(a);if(this._oRouter._oTargetHandler&&this._oRouter._oTargetHandler._chainNavigation){T=a;a=this._oRouter._oTargetHandler._chainNavigation(function(){return T})}}else{if(e.browser.msie||e.browser.edge){T=a;a=new Promise(function(e,t){setTimeout(function(){if(s._oTargets){var i=s._oTargets._display(p,d,C._oConfig.titleTarget,T);i.then(e,t)}else{e()}},0)})}else{a=s._oTargets._display(p,d,this._oConfig.titleTarget,a)}}return a.then(function(e){s._bMatchingProcessStarted=false;var i,o,a;if(Array.isArray(e)){i=e;e=i[0]}e=e||{};u=e.view;l=e.control;_.view=u;_.targetControl=l;if(i){o=[];a=[];i.forEach(function(e){o.push(e.view);a.push(e.control)});_.views=o;_.targetControls=a}if(f.callback){f.callback(this,r,f,l,u)}this.fireEvent("matched",_);s.fireRouteMatched(_);if(c){t.info("The route named '"+f.name+"' did match with its pattern",this);this.fireEvent("patternMatched",_);s.fireRoutePatternMatched(_)}return e}.bind(this))}}});